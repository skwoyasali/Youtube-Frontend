import{f as R,u as T,r,j as e,L as ne,e as le}from"./index-BBDrbdVF.js";import{a as h}from"./index-NIGUFBhG.js";import{q as ie,r as re,s as de,t as ce}from"./index-7ekGWKMM.js";import oe from"./CreateChannel-Dvhl1ib2.js";function me(){var A;const{sidebarOpen:I}=R(),{user:n}=T(),[l,p]=r.useState(null),[f,b]=r.useState([]),[P,v]=r.useState(null),[z,he]=r.useState(!1),[O,D]=r.useState(!0),[$,_]=r.useState(null),[H,F]=r.useState(!1),[Y,w]=r.useState(!1),[U,k]=r.useState(null),[u,G]=r.useState("Videos"),[x,y]=r.useState([]),C={title:"",videoLink:"",thumbnail:"",description:"",category:""},[s,j]=r.useState(C),[ue,g]=r.useState(!1),[J,S]=r.useState(!1),[c,L]=r.useState({channelName:"",channelBanner:"",channelPic:"",description:""}),[q,E]=r.useState(!1),[K,V]=r.useState(!1);r.useEffect(()=>{n!=null&&n.channelId&&(D(!0),_(null),h.get(`https://youtube-backend-0gem.onrender.com/api/channel/${n.channelId}`).then(t=>{p(t.data),b(t.data.videos||[])}).catch(t=>_("Failed to load channel.")).finally(()=>D(!1)))},[n==null?void 0:n.channelId]);const M=180;l&&l.description&&l.description.length>M,l&&l.description&&(z?l.description:l.description.slice(0,M));const Q=async t=>{if(window.confirm("Delete this video?"))try{await h.delete(`https://youtube-backend-0gem.onrender.com/api/video/${t}`,{headers:{Authorization:`Bearer ${n.token}`}}),b(a=>a.filter(d=>d._id!==t)),v(null),y(x.filter(a=>a!==t))}catch{alert("Failed to delete video")}},W=t=>{const a=f.find(d=>d._id===t);a&&(k(a),j({title:a.title||"",videoLink:a.videoLink||"",thumbnail:a.thumbnail||"",description:a.description||"",category:a.category||""}),w(!0)),v(null)},X=async t=>{var d,o;t.preventDefault(),g(!0);const a={title:s.title.trim(),videoLink:s.videoLink.trim(),thumbnail:s.thumbnail.trim(),description:s.description.trim(),category:s.category.trim()};if(!a.title||!a.videoLink||!a.thumbnail){alert("Please fill in all required fields."),g(!1);return}try{await h.post("https://youtube-backend-0gem.onrender.com/api/video",a,{headers:{Authorization:`Bearer ${n.token}`}});const i=await h.get(`https://youtube-backend-0gem.onrender.com/api/channel/${n.channelId}`);p(i.data),b(i.data.videos||[]),F(!1),j(C)}catch(i){alert("Failed to upload video: "+(((o=(d=i.response)==null?void 0:d.data)==null?void 0:o.message)||i.message))}finally{g(!1)}},Z=async t=>{var d,o;if(t.preventDefault(),!U)return;g(!0);const a={title:s.title.trim(),videoLink:s.videoLink.trim(),thumbnail:s.thumbnail.trim(),description:s.description.trim(),category:s.category.trim()};if(!a.title||!a.videoLink||!a.thumbnail){alert("Please fill in all required fields."),g(!1);return}try{await h.put(`https://youtube-backend-0gem.onrender.com/api/video/${U._id}`,a,{headers:{Authorization:`Bearer ${n.token}`}});const i=await h.get(`https://youtube-backend-0gem.onrender.com/api/channel/${n.channelId}`);p(i.data),b(i.data.videos||[]),w(!1),k(null),j(C)}catch(i){alert("Failed to update video: "+(((o=(d=i.response)==null?void 0:d.data)==null?void 0:o.message)||i.message))}finally{g(!1)}},ee=()=>{L({channelName:l.channelName||"",channelBanner:l.channelBanner||"",channelPic:l.channelPic||"",description:l.description||""}),S(!0)},N=t=>{const{name:a,value:d,files:o}=t.target;if(o){const i=o[0],B=new FileReader;B.onloadend=()=>L(se=>({...se,[a]:B.result})),B.readAsDataURL(i)}else L(i=>({...i,[a]:d}))},te=async t=>{var d,o;t.preventDefault(),E(!0);const a={channelName:c.channelName.trim(),channelBanner:c.channelBanner.trim(),channelPic:c.channelPic.trim(),description:c.description.trim()};if(!a.channelName){alert("Channel name is required."),E(!1);return}try{await h.put(`https://youtube-backend-0gem.onrender.com/api/updateChannel/${l._id}`,a,{headers:{Authorization:`Bearer ${n.token}`}});const i=await h.get(`https://youtube-backend-0gem.onrender.com/api/channel/${n.channelId}`);p(i.data),S(!1)}catch(i){alert("Failed to update channel: "+(((o=(d=i.response)==null?void 0:d.data)==null?void 0:o.message)||i.message))}finally{E(!1)}},m=t=>j({...s,[t.target.name]:t.target.value}),ae=async()=>{if(window.confirm(`Delete ${x.length} video(s)?`))try{await Promise.all(x.map(a=>h.delete(`https://youtube-backend-0gem.onrender.com/api/video/${a}`,{headers:{Authorization:`Bearer ${n.token}`}})));const t=await h.get(`https://youtube-backend-0gem.onrender.com/api/channel/${n.channelId}`);p(t.data),b(t.data.videos||[]),y([]),V(!1)}catch{alert("Failed to delete videos")}};return O?e.jsx("div",{className:"p-8",children:"Loading..."}):$?e.jsx("div",{className:"p-8 text-red-600",children:$}):l?e.jsxs("div",{className:"flex flex-col pt-16 min-h-screen bg-white text-gray-900 pb-5",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:l.channelBanner||"https://placehold.co/600x150.png?text=Banner",alt:"Channel banner",className:"w-full h-36 object-cover"}),e.jsxs("div",{className:"flex items-center p-4",children:[e.jsx("div",{className:"w-20 h-20 overflow-hidden",children:e.jsx("img",{className:"rounded-full ",src:l.channelPic||"https://placehold.co/100x100.png?text=channel",alt:l.channelName})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("h1",{className:"text-2xl font-bold",children:l.channelName}),e.jsxs("p",{className:"text-gray-500",children:["@",(A=l.channelName)==null?void 0:A.toLowerCase().replace(/\s/g,""),"498 •"," ",l.subscribers," subscribers • ",f.length," videos"]}),e.jsx("p",{className:"text-gray-500 mt-1",children:l.description}),e.jsxs("div",{className:"flex space-x-2 mt-2",children:[e.jsx("button",{onClick:ee,className:"px-4 py-2 bg-gray-200 rounded-full hover:bg-gray-300",children:"Customize channel"}),e.jsx("button",{onClick:()=>V(!0),className:"px-4 py-2 bg-gray-200 rounded-full hover:bg-gray-300",children:"Manage videos"})]})]})]})]}),e.jsx("div",{className:"flex border-b border-gray-300",children:["Home","Videos","Shorts","Playlists","Posts"].map(t=>e.jsx("div",{onClick:()=>G(t),className:`px-4 py-2 cursor-pointer ${u===t?"border-b-2 border-red-600":""}`,children:t},t))}),u==="Videos"&&e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 p-4 shadow-lg",children:f.map(t=>e.jsxs("div",{className:"relative",children:[e.jsxs(ne,{to:`/video/${t._id}`,children:[e.jsx("img",{src:t.thumbnail,alt:t.title,className:"w-full h-48 object-cover rounded"}),e.jsx("div",{className:"absolute bottom-2 right-2 bg-black bg-opacity-75 text-white px-1 text-sm",children:t.duration||"14:45"})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("h3",{className:"text-sm font-semibold",children:t.title}),e.jsxs("p",{className:"text-xs text-gray-500",children:[t.views," views • Streamed 4 years ago"]})]}),e.jsxs("div",{className:"absolute top-2 right-2",children:[e.jsx(le,{className:"cursor-pointer font-bold text-2xl text-gray-700",onClick:()=>v(P===t._id?null:t._id)}),P===t._id&&e.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white border border-gray-300 rounded shadow-lg",children:[e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100",onClick:()=>W(t._id),children:[e.jsx(ie,{})," Edit"]}),e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 text-red-600",onClick:()=>Q(t._id),children:[e.jsx(re,{})," Delete"]})]})]})]},t._id))}),u==="Home"&&e.jsx("div",{className:"p-4",children:"Home content goes here..."}),u==="Shorts"&&e.jsx("div",{className:"p-4",children:"Shorts content goes here..."}),u==="Playlists"&&e.jsx("div",{className:"p-4",children:"Playlists content goes here..."}),u==="Posts"&&e.jsx("div",{className:"p-4",children:"Posts content goes here..."}),J&&e.jsx("div",{className:"fixed inset-0 pt-14 bg-black bg-opacity-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg w-96 text-gray-900",children:[e.jsx("h2",{className:"text-xl mb-4",children:"Edit Channel Details"}),e.jsxs("form",{className:"w-full max-w-sm mx-auto p-3 bg-white rounded-md shadow gap-y-2 flex flex-col",onSubmit:te,children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Channel Name"}),e.jsx("input",{className:"text-sm px-2 py-1 border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-red-500",name:"channelName",type:"text",value:c.channelName,onChange:N,required:!0}),e.jsx("label",{className:"text-sm text-gray-600",children:"Description"}),e.jsx("textarea",{className:"text-sm px-2 py-1 border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-red-500 resize-none",name:"description",value:c.description,onChange:N,rows:2}),e.jsx("label",{className:"text-sm text-gray-600",children:"Banner URL"}),e.jsx("input",{className:"text-sm px-2 py-1 border border-gray-300 rounded",name:"channelBanner",type:"url",value:c.channelBanner,onChange:N}),e.jsx("img",{src:c.channelBanner||"https://placehold.co/600x150",alt:"Banner",className:"w-full h-16 object-cover rounded border"}),e.jsx("label",{className:"text-sm text-gray-600",children:"Channel Picture URL"}),e.jsx("input",{className:"text-sm px-2 py-1 border border-gray-300 rounded",name:"channelPic",type:"url",value:c.channelPic,onChange:N}),e.jsx("img",{src:c.channelPic||"https://placehold.co/100x100",alt:"Avatar",className:"w-16 h-16 rounded-full object-cover border"}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsxs("button",{type:"button",onClick:()=>S(!1),className:"flex items-center text-sm px-3 py-1 bg-gray-100 text-gray-700 rounded hover:bg-gray-200",children:[e.jsx(de,{className:"mr-1"}),"Cancel"]}),e.jsxs("button",{type:"submit",disabled:q||!c.channelName,className:"flex items-center text-sm px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700 disabled:opacity-50",children:[e.jsx(ce,{className:"mr-1"}),q?"Saving...":"Save"]})]})]})]})}),H&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg w-96 text-gray-900",children:[e.jsx("h2",{className:"text-xl mb-4",children:"Upload Video"}),e.jsxs("form",{onSubmit:X,children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Video Title"}),e.jsx("input",{name:"title",value:s.title,onChange:m,placeholder:"Video title",className:"w-full p-2 mb-2 bg-gray-100 rounded",required:!0}),e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Video Link"}),e.jsx("input",{name:"videoLink",value:s.videoLink,onChange:m,placeholder:"Video file URL",className:"w-full p-2 mb-2 bg-gray-100 rounded",required:!0}),e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Thumbnail Link"}),e.jsx("input",{name:"thumbnail",value:s.thumbnail,onChange:m,placeholder:"Thumbnail image URL",className:"w-full p-2 mb-2 bg-gray-100 rounded",required:!0}),e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{name:"description",value:s.description,onChange:m,placeholder:"Video description",className:"w-full p-2 mb-2 bg-gray-100 rounded",rows:2}),e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),e.jsx("input",{name:"category",value:s.category,onChange:m,placeholder:"Category",className:"w-full p-2 mb-2 bg-gray-100 rounded"}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>F(!1),className:"px-4 py-2 bg-gray-200 rounded hover:bg-gray-300",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Upload"})]})]})]})}),Y&&e.jsx("div",{className:"pt-16 fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg w-96 text-gray-900",children:[e.jsx("h2",{className:"text-xl mb-4",children:"Edit Video"}),e.jsxs("form",{onSubmit:Z,children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Video Title"}),e.jsx("input",{name:"title",value:s.title,onChange:m,placeholder:"Video title",className:"w-full p-2 mb-2 bg-gray-100 rounded",required:!0}),e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Video Link"}),e.jsx("input",{name:"videoLink",value:s.videoLink,onChange:m,placeholder:"Video file URL",className:"w-full p-2 mb-2 bg-gray-100 rounded",required:!0}),e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Thumbnail Url"}),e.jsx("input",{name:"thumbnail",value:s.thumbnail,onChange:m,placeholder:"Thumbnail image URL",className:"w-full p-2 mb-2 bg-gray-100 rounded",required:!0}),e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{name:"description",value:s.description,onChange:m,placeholder:"Video description",className:"w-full p-2 mb-2 bg-gray-100 rounded",rows:2}),e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),e.jsx("input",{name:"category",value:s.category,onChange:m,placeholder:"Category",className:"w-full p-2 mb-2 bg-gray-100 rounded"}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>{w(!1),k(null)},className:"px-4 py-2 bg-gray-200 rounded hover:bg-gray-300",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Save"})]})]})]})}),K&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg w-96 text-gray-900",children:[e.jsx("h2",{className:"text-xl mb-4",children:"Manage Videos"}),e.jsx("div",{className:"mb-4",children:f.map(t=>e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("input",{type:"checkbox",checked:x.includes(t._id),onChange:a=>{a.target.checked?y([...x,t._id]):y(x.filter(d=>d!==t._id))},className:"mr-2"}),e.jsx("span",{children:t.title})]},t._id))}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx("button",{onClick:ae,className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Delete Selected"}),e.jsx("button",{onClick:()=>V(!1),className:"px-4 py-2 bg-gray-200 rounded hover:bg-gray-300",children:"Close"})]})]})})]}):null}function fe(){const{sidebarOpen:I}=R(),{user:n}=T();return e.jsx("div",{className:"sm:ml-16",children:n!=null&&n.channelId?e.jsx(me,{}):e.jsx(oe,{})})}export{fe as default};
